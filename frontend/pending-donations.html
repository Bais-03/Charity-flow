<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pending Donations</title>
</head>
<body>
    <a href="admin-dashboard.html">â¬… Back to Dashboard</a>
  <h2>Pending Donations</h2>
  <div id="donationList"></div>

  <script>
    (async function () {
      const token = localStorage.getItem("adminToken");
      const container = document.getElementById("donationList");

      const res = await fetch("http://localhost:5001/api/donations", {
        headers: { Authorization: `Bearer ${token}` }
      });

      const donations = await res.json();

      const pending = donations.filter(d => d.status === "Pending");

      pending.forEach(d => {
        const div = document.createElement("div");
        div.innerHTML = `
          <h4>${d.itemName} (${d.itemType})</h4>
          <img src="http://localhost:5001/${d.photo}" alt="Item Image" width="150" />
          <p>Quantity: ${d.quantity}</p>
          <p>User: ${d.userId?.name || 'N/A'} - ${d.userId?.email || 'N/A'}</p>
          <button onclick="updateStatus('${d._id}', 'Accepted')">Accept</button>
          <button onclick="updateStatus('${d._id}', 'Rejected')">Reject</button>
          <hr/>
        `;
        container.appendChild(div);
      });
    })();

    async function updateStatus(id, status) {
      const token = localStorage.getItem("adminToken");

      const res = await fetch(`http://localhost:5001/api/donations/${id}/status`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${token}`
        },
        body: JSON.stringify({ status })
      });

      const data = await res.json();
      alert(data.message);
      location.reload();
    }
  </script>
</body>
</html>
